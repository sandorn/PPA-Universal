# PPA é¡¹ç›®æ¶æ„é‡æ„æ•´åˆæ–¹æ¡ˆ

**ç‰ˆæœ¬**: v1.1  
**åˆ¶å®šæ—¥æœŸ**: 2025 å¹´ 1 æœˆ  
**æœ€åæ›´æ–°**: 2025 å¹´ 1 æœˆ  
**çŠ¶æ€**: âœ… éƒ¨åˆ†å®æ–½å®Œæˆï¼ˆDI å®¹å™¨ + PowerPoint é€‚é…å™¨ï¼‰

---

## ğŸ“‹ ä¸€ã€æ–¹æ¡ˆæ¦‚è¿°

### 1.1 æ•´åˆå†…å®¹

æœ¬æ–¹æ¡ˆæ•´åˆäº†ä¸¤ä¸ªæ¶æ„æ”¹è¿›æ–¹æ¡ˆï¼š

1. **ä¾èµ–æ³¨å…¥ï¼ˆDIï¼‰å®¹å™¨æ–¹æ¡ˆ**ï¼ˆæ¥è‡ªé¡¹ç›®æ£€æµ‹æŠ¥å‘Šï¼‰

   - ç›®æ ‡ï¼šè§£è€¦ç»„ä»¶ä¾èµ–ï¼Œæé«˜å¯æµ‹è¯•æ€§
   - æ–¹æ³•ï¼šå¼•å…¥ DI å®¹å™¨ï¼Œå°†é™æ€ç±»è½¬æ¢ä¸ºå®ä¾‹ç±»

2. **å¹³å°æŠ½è±¡å±‚æ–¹æ¡ˆ**ï¼ˆæ¥è‡ª WPS æ”¯æŒæ–¹æ¡ˆï¼‰
   - ç›®æ ‡ï¼šæ”¯æŒå¤šå¹³å°ï¼ˆPowerPoint + WPSï¼‰
   - æ–¹æ³•ï¼šåˆ›å»ºå¹³å°æŠ½è±¡æ¥å£å’Œé€‚é…å™¨

### 1.2 æ•´åˆä¼˜åŠ¿

- âœ… **æ›´å¥½çš„å¯æµ‹è¯•æ€§**ï¼šDI å®¹å™¨ + æ¥å£æŠ½è±¡
- âœ… **æ›´å¥½çš„å¯æ‰©å±•æ€§**ï¼šå¹³å°æŠ½è±¡ + ä¾èµ–æ³¨å…¥
- âœ… **æ›´æ¸…æ™°çš„æ¶æ„**ï¼šåˆ†å±‚æ˜ç¡®ï¼ŒèŒè´£æ¸…æ™°
- âœ… **æ›´å®¹æ˜“ç»´æŠ¤**ï¼šç»„ä»¶è§£è€¦ï¼Œå¹³å°éš”ç¦»
- âœ… **ç»Ÿä¸€ç®¡ç†**ï¼šé€šè¿‡ DI å®¹å™¨ç»Ÿä¸€ç®¡ç†æ‰€æœ‰æœåŠ¡

### 1.3 æœ€ç»ˆæ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  UIå±‚ (CustomRibbon, Forms)         â”‚
â”‚  â””â”€ é€šè¿‡DIæ³¨å…¥ä¸šåŠ¡æœåŠ¡              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ä¸šåŠ¡æœåŠ¡å±‚ (IFormatHelperç­‰)       â”‚
â”‚  â””â”€ é€šè¿‡DIæ³¨å…¥å¹³å°é€‚é…å™¨            â”‚
â”‚  â””â”€ ä½¿ç”¨å¹³å°æŠ½è±¡æ¥å£                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  å¹³å°æŠ½è±¡æ¥å£å±‚ (IApplicationç­‰)     â”‚
â”‚  â””â”€ é€šè¿‡DIæ³¨å†Œå¹³å°é€‚é…å™¨            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  PowerPointé€‚é…å™¨ â”‚  WPSé€‚é…å™¨        â”‚
â”‚  (é€šè¿‡DIæ³¨å†Œ)     â”‚  (é€šè¿‡DIæ³¨å†Œ)     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ¯ äºŒã€å®æ–½ç›®æ ‡

### 2.1 çŸ­æœŸç›®æ ‡ï¼ˆ1-2 ä¸ªæœˆï¼‰

1. âœ… å¼•å…¥ DI å®¹å™¨ï¼Œè§£è€¦ç»„ä»¶ä¾èµ–
2. âœ… å°†é™æ€ç±»è½¬æ¢ä¸ºå®ä¾‹ç±»
3. âœ… åˆ›å»ºå¹³å°æŠ½è±¡æ¥å£å±‚
4. âœ… å®ç° PowerPoint é€‚é…å™¨
5. âœ… é‡æ„ç°æœ‰ä»£ç ä½¿ç”¨æ–°æ¶æ„

### 2.2 ä¸­æœŸç›®æ ‡ï¼ˆ2-3 ä¸ªæœˆï¼‰

1. âœ… å®ç° WPS é€‚é…å™¨
2. âœ… å®ŒæˆåŠŸèƒ½é€‚é…å’Œæµ‹è¯•
3. âœ… æ”¯æŒ WPS æ¼”ç¤º

### 2.3 é•¿æœŸæ”¶ç›Š

1. âœ… ä»£ç å¯æµ‹è¯•æ€§æ˜¾è‘—æé«˜
2. âœ… æ”¯æŒå¤šå¹³å°ï¼ˆPowerPoint + WPSï¼‰
3. âœ… æ¶æ„æ¸…æ™°ï¼Œæ˜“äºç»´æŠ¤å’Œæ‰©å±•
4. âœ… æ–°åŠŸèƒ½å¼€å‘æ•ˆç‡æå‡

---

## ğŸ“¦ ä¸‰ã€è¯¦ç»†å®æ–½è®¡åˆ’

### é˜¶æ®µä¸€ï¼šDI å®¹å™¨åŸºç¡€è®¾æ–½ï¼ˆ1-2 å‘¨ï¼‰

**ç›®æ ‡**ï¼šå»ºç«‹ DI å®¹å™¨åŸºç¡€è®¾æ–½ï¼Œä¸ºåç»­é‡æ„æ‰“å¥½åŸºç¡€

#### 3.1.1 å®‰è£…å’Œé…ç½® DI å®¹å™¨

- [ ] **å®‰è£… NuGet åŒ…**

  ```powershell
  Install-Package Microsoft.Extensions.DependencyInjection
  Install-Package Microsoft.Extensions.DependencyInjection.Abstractions
  ```

- [ ] **åˆ›å»º DI å®¹å™¨æ‰©å±•ç±»**

  ```csharp
  // Core/DI/ServiceCollectionExtensions.cs
  namespace PPA.Core.DI
  {
      public static class ServiceCollectionExtensions
      {
          public static IServiceCollection AddPPAServices(this IServiceCollection services)
          {
              // æ³¨å†Œæ ¸å¿ƒæœåŠ¡
              services.AddSingleton<IFormattingConfig>(sp => FormattingConfig.Instance);
              // ... å…¶ä»–æœåŠ¡æ³¨å†Œ
              return services;
          }
      }
  }
  ```

- [ ] **åœ¨ ThisAddIn ä¸­åˆå§‹åŒ– DI å®¹å™¨**

  ```csharp
  // ThisAddIn.cs
  private IServiceProvider _serviceProvider;

  private void InitializeDIContainer()
  {
      var services = new ServiceCollection();
      services.AddPPAServices();
      _serviceProvider = services.BuildServiceProvider();
  }
  ```

#### 3.1.2 å®šä¹‰æ ¸å¿ƒä¸šåŠ¡æ¥å£

- [ ] **åˆ›å»ºä¸šåŠ¡æ¥å£**

  ```csharp
  // Core/Abstraction/Business/IFormatHelper.cs
  namespace PPA.Core.Abstraction.Business
  {
      public interface IFormatHelper
      {
          void FormatTables(/* å‚æ•°å¾…å®šï¼Œåç»­æ”¹ä¸ºä½¿ç”¨å¹³å°æŠ½è±¡æ¥å£ */);
          void ApplyTextFormatting(/* ... */);
          void FormatChartText(/* ... */);
      }
  }

  // Core/Abstraction/Business/IBatchHelper.cs
  public interface IBatchHelper { ... }

  // Core/Abstraction/Business/IAlignHelper.cs
  public interface IAlignHelper { ... }

  // Core/Abstraction/Business/IShapeHelper.cs
  public interface IShapeHelper { ... }
  ```

- [ ] **åˆ›å»ºé…ç½®æ¥å£**
  ```csharp
  // Core/Abstraction/Business/IFormattingConfig.cs
  public interface IFormattingConfig
  {
      TableFormattingConfig Table { get; }
      TextFormattingConfig Text { get; }
      ChartFormattingConfig Chart { get; }
      ShortcutsConfig Shortcuts { get; }
  }
  ```

#### 3.1.3 éªŒæ”¶æ ‡å‡†

- [ ] DI å®¹å™¨å¯ä»¥æ­£å¸¸åˆå§‹åŒ–å’Œä½¿ç”¨
- [ ] æ ¸å¿ƒæ¥å£å®šä¹‰å®Œæˆ
- [ ] å¯ä»¥åœ¨ ThisAddIn ä¸­è·å–æœåŠ¡

---

### é˜¶æ®µäºŒï¼šä¸šåŠ¡å±‚é‡æ„ï¼ˆ2-3 å‘¨ï¼‰

**ç›®æ ‡**ï¼šå°†é™æ€ç±»è½¬æ¢ä¸ºå®ä¾‹ç±»ï¼Œæå–æ¥å£ï¼Œæ³¨å†Œåˆ° DI å®¹å™¨

#### 3.2.1 é‡æ„æ ¼å¼åŒ–æ¨¡å—

- [ ] **å°† TableFormatHelper è½¬æ¢ä¸ºå®ä¾‹ç±»**

  ```csharp
  // Formatting/TableFormatHelper.cs
  namespace PPA.Formatting
  {
      // ä» static class æ”¹ä¸ºæ™®é€šç±»
      public class TableFormatHelper : ITableFormatHelper
      {
          private readonly IFormattingConfig _config;

          public TableFormatHelper(IFormattingConfig config)
          {
              _config = config;
          }

          // æ–¹æ³•ä» static æ”¹ä¸ºå®ä¾‹æ–¹æ³•
          public void FormatTables(/* ... */) { ... }
      }
  }
  ```

- [ ] **æå–æ¥å£**

  ```csharp
  // Core/Abstraction/Business/ITableFormatHelper.cs
  public interface ITableFormatHelper
  {
      void FormatTables(/* ... */);
  }
  ```

- [ ] **æ³¨å†Œåˆ° DI å®¹å™¨**

  ```csharp
  services.AddTransient<ITableFormatHelper, TableFormatHelper>();
  ```

- [ ] **åŒæ ·å¤„ç†å…¶ä»–æ ¼å¼åŒ–ç±»**
  - [ ] TextFormatHelper â†’ ITextFormatHelper
  - [ ] ChartFormatHelper â†’ IChartFormatHelper

#### 3.2.2 é‡æ„æ‰¹é‡æ“ä½œæ¨¡å—

- [ ] **å°† BatchHelper è½¬æ¢ä¸ºå®ä¾‹ç±»**

  ```csharp
  // Formatting/TableBatchHelper.cs
  public class TableBatchHelper : ITableBatchHelper
  {
      private readonly ITableFormatHelper _formatHelper;
      private readonly IFormattingConfig _config;

      public TableBatchHelper(
          ITableFormatHelper formatHelper,
          IFormattingConfig config)
      {
          _formatHelper = formatHelper;
          _config = config;
      }

      // æ–¹æ³•å®ç°...
  }
  ```

- [ ] **æå–æ¥å£å¹¶æ³¨å†Œ**
  - [ ] ITableBatchHelper
  - [ ] ITextBatchHelper
  - [ ] IChartBatchHelper
  - [ ] IShapeBatchHelper

#### 3.2.3 é‡æ„å¯¹é½å·¥å…·æ¨¡å—

- [ ] **å°† AlignHelper è½¬æ¢ä¸ºå®ä¾‹ç±»**

  ```csharp
  // Formatting/AlignHelper.cs
  public class AlignHelper : IAlignHelper
  {
      // å®ç°...
  }
  ```

- [ ] **æå–æ¥å£å¹¶æ³¨å†Œ**
  ```csharp
  services.AddTransient<IAlignHelper, AlignHelper>();
  ```

#### 3.2.4 é‡æ„å½¢çŠ¶å·¥å…·æ¨¡å—

- [ ] **å°† ShapeUtils è½¬æ¢ä¸ºå®ä¾‹ç±»**

  ```csharp
  // Shape/ShapeUtils.cs
  public class ShapeUtils : IShapeUtils
  {
      // å®ç°...
  }
  ```

- [ ] **æå–æ¥å£å¹¶æ³¨å†Œ**

#### 3.2.5 æ›´æ–°è°ƒç”¨æ–¹

- [ ] **ä¿®æ”¹ CustomRibbon ä½¿ç”¨ DI**

  ```csharp
  // UI/CustomRibbon.cs
  public class CustomRibbon : Office.IRibbonExtensibility, IDisposable
  {
      private readonly IServiceProvider _serviceProvider;
      private ITableBatchHelper _tableBatchHelper;
      private ITextBatchHelper _textBatchHelper;
      // ...

      public CustomRibbon(IServiceProvider serviceProvider)
      {
          _serviceProvider = serviceProvider;
          // å»¶è¿Ÿè·å–æœåŠ¡ï¼ˆå› ä¸ºæ­¤æ—¶Applicationå¯èƒ½è¿˜æœªåˆå§‹åŒ–ï¼‰
      }

      public void SetApplication(/* ... */)
      {
          // Applicationåˆå§‹åŒ–åï¼Œè·å–æœåŠ¡
          _tableBatchHelper = _serviceProvider.GetService<ITableBatchHelper>();
          // ...
      }
  }
  ```

- [ ] **ä¿®æ”¹ ThisAddIn åˆ›å»º CustomRibbon**
  ```csharp
  // ThisAddIn.cs
  protected override Office.IRibbonExtensibility CreateRibbonExtensibilityObject()
  {
      _customRibbon = new CustomRibbon(_serviceProvider);
      return _customRibbon;
  }
  ```

#### 3.2.6 ä¿æŒå‘åå…¼å®¹ï¼ˆå¯é€‰ï¼‰

- [ ] **ä¸ºé™æ€ç±»æ·»åŠ ä¾¿æ·æ–¹æ³•**
  ```csharp
  // Formatting/TableFormatHelper.cs
  public static class TableFormatHelperLegacy
  {
      // ä¿ç•™é™æ€æ–¹æ³•ä½œä¸ºä¾¿æ·å…¥å£
      public static void FormatTables(/* ... */)
      {
          var helper = Globals.ServiceProvider.GetService<ITableFormatHelper>();
          helper.FormatTables(/* ... */);
      }
  }
  ```

#### 3.2.7 éªŒæ”¶æ ‡å‡†

- [ ] æ‰€æœ‰é™æ€ç±»å·²è½¬æ¢ä¸ºå®ä¾‹ç±»
- [ ] æ‰€æœ‰æ¥å£å·²æå–å¹¶æ³¨å†Œåˆ° DI å®¹å™¨
- [ ] CustomRibbon é€šè¿‡ DI è·å–æœåŠ¡
- [ ] åŠŸèƒ½æµ‹è¯•é€šè¿‡ï¼ˆPowerPoint åŠŸèƒ½æ­£å¸¸ï¼‰

---

### é˜¶æ®µä¸‰ï¼šå¹³å°æŠ½è±¡å±‚ï¼ˆ2-3 å‘¨ï¼‰

**ç›®æ ‡**ï¼šåˆ›å»ºå¹³å°æŠ½è±¡æ¥å£å’Œ PowerPoint é€‚é…å™¨

#### 3.3.1 åˆ›å»ºå¹³å°æŠ½è±¡æ¥å£

- [ ] **åˆ›å»ºæ ¸å¿ƒå¹³å°æ¥å£**

  ```csharp
  // Core/Abstraction/Platform/IApplication.cs
  namespace PPA.Core.Abstraction.Platform
  {
      public interface IApplication
      {
          ApplicationType Type { get; }
          IPresentation ActivePresentation { get; }
          // å…¶ä»–é€šç”¨æ¥å£...
      }

      public enum ApplicationType
      {
          PowerPoint,
          WPSPresentation,
          Unknown
      }
  }

  // Core/Abstraction/Platform/IPresentation.cs
  public interface IPresentation
  {
      ISlide ActiveSlide { get; }
      ISlideCollection Slides { get; }
      // ...
  }

  // Core/Abstraction/Platform/ISlide.cs
  public interface ISlide
  {
      IShapeCollection Shapes { get; }
      // ...
  }

  // Core/Abstraction/Platform/ITable.cs
  public interface ITable
  {
      int Rows { get; }
      int Columns { get; }
      ICell Cell(int row, int column);
      // ...
  }

  // Core/Abstraction/Platform/ITextRange.cs
  public interface ITextRange
  {
      string Text { get; set; }
      IFont Font { get; }
      // ...
  }

  // Core/Abstraction/Platform/IChart.cs
  public interface IChart { ... }

  // Core/Abstraction/Platform/IShape.cs
  public interface IShape { ... }
  ```

- [ ] **å®šä¹‰æšä¸¾ç±»å‹**
  ```csharp
  // Core/Abstraction/Platform/FeatureSupportLevel.cs
  public enum FeatureSupportLevel
  {
      Full,      // å®Œå…¨æ”¯æŒ
      Partial,   // éƒ¨åˆ†æ”¯æŒ
      None       // ä¸æ”¯æŒ
  }
  ```

#### 3.3.2 å®ç° PowerPoint é€‚é…å™¨

- [ ] **åˆ›å»º PowerPoint é€‚é…å™¨ç±»**

  ```csharp
  // Core/Adapters/PowerPoint/PowerPointApplication.cs
  namespace PPA.Core.Adapters.PowerPoint
  {
      public class PowerPointApplication : IApplication
      {
          private readonly NETOP.Application _netApp;

          public PowerPointApplication(NETOP.Application netApp)
          {
              _netApp = netApp ?? throw new ArgumentNullException(nameof(netApp));
          }

          public ApplicationType Type => ApplicationType.PowerPoint;

          public IPresentation ActivePresentation
          {
              get
              {
                  try
                  {
                      var pres = _netApp.ActivePresentation;
                      return pres != null ? new PowerPointPresentation(pres) : null;
                  }
                  catch (Exception ex)
                  {
                      Profiler.LogMessage($"è·å–æ´»åŠ¨æ¼”ç¤ºæ–‡ç¨¿å¤±è´¥: {ex.Message}");
                      return null;
                  }
              }
          }
      }
  }

  // Core/Adapters/PowerPoint/PowerPointPresentation.cs
  public class PowerPointPresentation : IPresentation
  {
      private readonly NETOP.Presentation _netPres;

      public PowerPointPresentation(NETOP.Presentation netPres)
      {
          _netPres = netPres;
      }

      public ISlide ActiveSlide
      {
          get
          {
              var slide = _netPres.SlideShowWindow?.View?.Slide;
              return slide != null ? new PowerPointSlide(slide) : null;
          }
      }

      // å®ç°å…¶ä»–æ¥å£...
  }

  // Core/Adapters/PowerPoint/PowerPointTable.cs
  public class PowerPointTable : ITable
  {
      private readonly NETOP.Table _netTable;

      public PowerPointTable(NETOP.Table netTable)
      {
          _netTable = netTable;
      }

      public int Rows => _netTable.Rows.Count;
      public int Columns => _netTable.Columns.Count;

      public ICell Cell(int row, int column)
      {
          var cell = _netTable.Cell(row, column);
          return new PowerPointCell(cell);
      }

      // å®ç°å…¶ä»–æ¥å£...
  }

  // å…¶ä»–é€‚é…å™¨ç±»...
  // - PowerPointSlide
  // - PowerPointTextRange
  // - PowerPointChart
  // - PowerPointShape
  ```

#### 3.3.3 åˆ›å»ºåº”ç”¨ç¨‹åºå·¥å‚

- [ ] **å®ç° ApplicationFactory**

  ```csharp
  // Core/Adapters/ApplicationFactory.cs
  namespace PPA.Core.Adapters
  {
      public static class ApplicationFactory
      {
          public static IApplication Create(object nativeApp)
          {
              if (nativeApp == null)
                  throw new ArgumentNullException(nameof(nativeApp));

              ApplicationType type = ApplicationDetector.DetectType(nativeApp);

              switch (type)
              {
                  case ApplicationType.PowerPoint:
                      if (nativeApp is NETOP.Application netApp)
                          return new PowerPointApplication(netApp);
                      else if (nativeApp is MSOP.Application msApp)
                      {
                          var netAppWrapper = new NETOP.Application(null, msApp);
                          return new PowerPointApplication(netAppWrapper);
                      }
                      break;

                  case ApplicationType.WPSPresentation:
                      // åç»­å®ç°
                      throw new NotSupportedException("WPSé€‚é…å™¨å°šæœªå®ç°");

                  default:
                      throw new NotSupportedException($"ä¸æ”¯æŒçš„åº”ç”¨ç¨‹åºç±»å‹: {type}");
              }

              throw new InvalidOperationException("æ— æ³•åˆ›å»ºåº”ç”¨ç¨‹åºé€‚é…å™¨");
          }
      }

      public static class ApplicationDetector
      {
          public static ApplicationType DetectType(object app)
          {
              if (app == null) return ApplicationType.Unknown;

              string typeName = app.GetType().FullName;

              if (typeName.Contains("Microsoft.Office.Interop.PowerPoint") ||
                  typeName.Contains("NetOffice.PowerPointApi"))
              {
                  return ApplicationType.PowerPoint;
              }

              if (typeName.Contains("WPS") ||
                  IsWPSApplication(app))
              {
                  return ApplicationType.WPSPresentation;
              }

              return ApplicationType.Unknown;
          }

          private static bool IsWPSApplication(object app)
          {
              try
              {
                  dynamic dynApp = app;
                  string name = dynApp.Name;
                  return name != null && name.Contains("WPS");
              }
              catch
              {
                  return false;
              }
          }
      }
  }
  ```

#### 3.3.4 æ³¨å†Œå¹³å°é€‚é…å™¨åˆ° DI å®¹å™¨

- [ ] **æ›´æ–° DI å®¹å™¨æ³¨å†Œ**

  ```csharp
  // Core/DI/ServiceCollectionExtensions.cs
  public static IServiceCollection AddPPAServices(
      this IServiceCollection services,
      object nativeApplication)
  {
      // åˆ›å»ºå¹³å°é€‚é…å™¨
      var appAdapter = ApplicationFactory.Create(nativeApplication);

      // æ³¨å†Œä¸ºå•ä¾‹
      services.AddSingleton<IApplication>(appAdapter);

      // æ³¨å†Œå…¶ä»–æœåŠ¡...
      services.AddSingleton<IFormattingConfig>(sp => FormattingConfig.Instance);
      services.AddTransient<ITableFormatHelper, TableFormatHelper>();
      // ...

      return services;
  }
  ```

#### 3.3.5 é‡æ„ä¸šåŠ¡æ¥å£ä½¿ç”¨å¹³å°æŠ½è±¡

- [ ] **æ›´æ–°ä¸šåŠ¡æ¥å£ä½¿ç”¨å¹³å°æŠ½è±¡æ¥å£**

  ```csharp
  // Core/Abstraction/Business/ITableFormatHelper.cs
  public interface ITableFormatHelper
  {
      // ä» NETOP.Application æ”¹ä¸º IApplication
      // ä» NETOP.Table æ”¹ä¸º ITable
      void FormatTables(IApplication app, ISlide slide, ITable table);
  }

  // Formatting/TableFormatHelper.cs
  public class TableFormatHelper : ITableFormatHelper
  {
      private readonly IFormattingConfig _config;

      public TableFormatHelper(IFormattingConfig config)
      {
          _config = config;
      }

      public void FormatTables(IApplication app, ISlide slide, ITable table)
      {
          // ä½¿ç”¨å¹³å°æŠ½è±¡æ¥å£å®ç°
          // ä¸å†ç›´æ¥ä¾èµ– NetOffice æˆ– PowerPoint API
      }
  }
  ```

- [ ] **æ›´æ–° CustomRibbon è°ƒç”¨**

  ```csharp
  // UI/CustomRibbon.cs
  public void Bt501_Click(Office.IRibbonControl control)
  {
      var app = _serviceProvider.GetService<IApplication>();
      var pres = app?.ActivePresentation;
      var slide = pres?.ActiveSlide;

      if (slide == null) return;

      // æŸ¥æ‰¾è¡¨æ ¼å¹¶æ ¼å¼åŒ–
      foreach (var shape in slide.Shapes)
      {
          if (shape.HasTable)
          {
              var table = shape.Table;
              var formatHelper = _serviceProvider.GetService<ITableFormatHelper>();
              formatHelper.FormatTables(app, slide, table);
          }
      }
  }
  ```

#### 3.3.6 æ›´æ–° ThisAddIn

- [ ] **ä¿®æ”¹ ThisAddIn ä½¿ç”¨å¹³å°æŠ½è±¡**

  ```csharp
  // ThisAddIn.cs
  private IApplication _app;
  private IServiceProvider _serviceProvider;

  private void ThisAddIn_Startup(object sender, System.EventArgs e)
  {
      ResourceManager.Initialize(/* ... */);

      // åˆå§‹åŒ–DIå®¹å™¨ï¼ˆéœ€è¦å…ˆæœ‰Applicationå¯¹è±¡ï¼‰
      InitializeNetOfficeApplication();

      // åˆ›å»ºå¹³å°é€‚é…å™¨
      _app = ApplicationFactory.Create(NetApp);

      // åˆå§‹åŒ–DIå®¹å™¨
      InitializeDIContainer();

      // è®¾ç½®CustomRibbon
      _customRibbon?.SetApplication(_app);

      // åˆå§‹åŒ–å¿«æ·é”®
      KeyboardShortcutHelper.Initialize(_app);
  }

  private void InitializeDIContainer()
  {
      var services = new ServiceCollection();
      services.AddPPAServices(_app);
      _serviceProvider = services.BuildServiceProvider();
  }
  ```

#### 3.3.7 éªŒæ”¶æ ‡å‡†

- [ ] å¹³å°æŠ½è±¡æ¥å£å®šä¹‰å®Œæˆ
- [ ] PowerPoint é€‚é…å™¨å®ç°å®Œæˆ
- [ ] ä¸šåŠ¡æ¥å£æ”¹ä¸ºä½¿ç”¨å¹³å°æŠ½è±¡æ¥å£
- [ ] åŠŸèƒ½æµ‹è¯•é€šè¿‡ï¼ˆPowerPoint åŠŸèƒ½æ­£å¸¸ï¼‰
- [ ] ä»£ç ä¸å†ç›´æ¥ä¾èµ– NetOffice æˆ– PowerPoint API

---

### é˜¶æ®µå››ï¼šWPS é€‚é…å™¨å¼€å‘ï¼ˆ3-4 å‘¨ï¼‰

**ç›®æ ‡**ï¼šå®ç° WPS é€‚é…å™¨ï¼Œæ”¯æŒ WPS æ¼”ç¤º

#### 3.4.1 WPS COM API ç ”ç©¶

- [ ] **ç ”ç©¶ WPS æ¼”ç¤º COM API æ–‡æ¡£**

  - [ ] æŸ¥æ‰¾ WPS å®˜æ–¹æ–‡æ¡£
  - [ ] äº†è§£ WPS COM å¯¹è±¡æ¨¡å‹
  - [ ] è¯†åˆ« API å·®å¼‚å’Œé™åˆ¶

- [ ] **åˆ›å»º WPS æµ‹è¯•ç¯å¢ƒ**

  - [ ] å®‰è£… WPS æ¼”ç¤º
  - [ ] åˆ›å»ºæµ‹è¯•é¡¹ç›®
  - [ ] éªŒè¯åŸºæœ¬ COM äº’æ“ä½œ

- [ ] **éªŒè¯ WPS COM äº’æ“ä½œæ€§**
  - [ ] æµ‹è¯•åˆ›å»º WPS åº”ç”¨ç¨‹åºå¯¹è±¡
  - [ ] æµ‹è¯•è®¿é—®æ¼”ç¤ºæ–‡ç¨¿
  - [ ] æµ‹è¯•è®¿é—®è¡¨æ ¼ã€æ–‡æœ¬ç­‰å¯¹è±¡

#### 3.4.2 å®ç° WPS é€‚é…å™¨

- [ ] **åˆ›å»º WPS é€‚é…å™¨ç±»**

  ```csharp
  // Core/Adapters/WPS/WPSApplication.cs
  namespace PPA.Core.Adapters.WPS
  {
      public class WPSApplication : IApplication
      {
          private dynamic _wpsApp;

          public WPSApplication(object nativeApp)
          {
              _wpsApp = nativeApp;
              ValidateWPSObject();
          }

          private void ValidateWPSObject()
          {
              try
              {
                  string name = _wpsApp.Name;
                  if (!name.Contains("WPS"))
                      throw new InvalidOperationException("ä¸æ˜¯æœ‰æ•ˆçš„WPSåº”ç”¨ç¨‹åºå¯¹è±¡");
              }
              catch (Exception ex)
              {
                  throw new InvalidOperationException($"WPSå¯¹è±¡éªŒè¯å¤±è´¥: {ex.Message}", ex);
              }
          }

          public ApplicationType Type => ApplicationType.WPSPresentation;

          public IPresentation ActivePresentation
          {
              get
              {
                  try
                  {
                      dynamic activePres = _wpsApp.ActivePresentation;
                      return activePres != null ? new WPSPresentation(activePres) : null;
                  }
                  catch (Exception ex)
                  {
                      Profiler.LogMessage($"è·å–WPSæ´»åŠ¨æ¼”ç¤ºæ–‡ç¨¿å¤±è´¥: {ex.Message}");
                      return null;
                  }
              }
          }
      }
  }

  // Core/Adapters/WPS/WPSPresentation.cs
  public class WPSPresentation : IPresentation
  {
      private dynamic _wpsPres;

      public WPSPresentation(object nativePres)
      {
          _wpsPres = nativePres;
      }

      // å®ç°æ¥å£...
  }

  // Core/Adapters/WPS/WPSTable.cs
  public class WPSTable : ITable
  {
      private dynamic _wpsTable;

      public WPSTable(object nativeTable)
      {
          _wpsTable = nativeTable;
      }

      // å®ç°æ¥å£ï¼Œå¤„ç†APIå·®å¼‚...
  }

  // å…¶ä»–WPSé€‚é…å™¨ç±»...
  ```

- [ ] **å¤„ç† API å·®å¼‚**
  - [ ] è¯†åˆ« WPS ä¸æ”¯æŒçš„ API
  - [ ] å®ç°é™çº§æ–¹æ¡ˆ
  - [ ] æ·»åŠ å…¼å®¹æ€§æ£€æŸ¥

#### 3.4.3 æ›´æ–° ApplicationFactory

- [ ] **æ·»åŠ  WPS æ”¯æŒ**

  ```csharp
  // Core/Adapters/ApplicationFactory.cs
  public static IApplication Create(object nativeApp)
  {
      // ... ç°æœ‰ä»£ç  ...

      switch (type)
      {
          case ApplicationType.PowerPoint:
              // ... ç°æœ‰ä»£ç  ...

          case ApplicationType.WPSPresentation:
              return new WPSApplication(nativeApp);

          // ...
      }
  }
  ```

#### 3.4.4 WPS æ’ä»¶åŠ è½½æœºåˆ¶

- [ ] **ç ”ç©¶ WPS æ’ä»¶å¼€å‘æ–‡æ¡£**

  - [ ] äº†è§£ WPS æ’ä»¶æ¶æ„
  - [ ] äº†è§£æ’ä»¶æ³¨å†Œæœºåˆ¶

- [ ] **åˆ›å»º WPS æ’ä»¶å…¥å£ç‚¹**ï¼ˆå¦‚æœéœ€è¦ï¼‰
  - [ ] åˆ›å»º WPS ç‰¹å®šçš„åˆå§‹åŒ–ä»£ç 
  - [ ] å¤„ç† WPS ç‰¹å®šçš„é…ç½®

#### 3.4.5 éªŒæ”¶æ ‡å‡†

- [ ] WPS é€‚é…å™¨å®ç°å®Œæˆ
- [ ] å¯ä»¥åœ¨ WPS ä¸­åŠ è½½æ’ä»¶
- [ ] åŸºæœ¬åŠŸèƒ½æµ‹è¯•é€šè¿‡
- [ ] API å·®å¼‚å¤„ç†å®Œæˆ

---

### é˜¶æ®µäº”ï¼šåŠŸèƒ½é€‚é…å’Œæµ‹è¯•ï¼ˆ2-3 å‘¨ï¼‰

**ç›®æ ‡**ï¼šå®ŒæˆåŠŸèƒ½é€‚é…ï¼Œç¡®ä¿ PowerPoint å’Œ WPS åŠŸèƒ½æ­£å¸¸

#### 3.5.1 æ ¸å¿ƒåŠŸèƒ½é€‚é…

- [ ] **è¡¨æ ¼æ ¼å¼åŒ–åŠŸèƒ½é€‚é…**

  - [ ] æµ‹è¯• PowerPoint è¡¨æ ¼æ ¼å¼åŒ–
  - [ ] æµ‹è¯• WPS è¡¨æ ¼æ ¼å¼åŒ–
  - [ ] å¤„ç†å¹³å°å·®å¼‚

- [ ] **æ–‡æœ¬æ ¼å¼åŒ–åŠŸèƒ½é€‚é…**

  - [ ] æµ‹è¯• PowerPoint æ–‡æœ¬æ ¼å¼åŒ–
  - [ ] æµ‹è¯• WPS æ–‡æœ¬æ ¼å¼åŒ–

- [ ] **å›¾è¡¨æ ¼å¼åŒ–åŠŸèƒ½é€‚é…**

  - [ ] æµ‹è¯• PowerPoint å›¾è¡¨æ ¼å¼åŒ–
  - [ ] æµ‹è¯• WPS å›¾è¡¨æ ¼å¼åŒ–ï¼ˆå¦‚æœæ”¯æŒï¼‰

- [ ] **å¯¹é½å·¥å…·é€‚é…**
  - [ ] æµ‹è¯• PowerPoint å¯¹é½åŠŸèƒ½
  - [ ] æµ‹è¯• WPS å¯¹é½åŠŸèƒ½

#### 3.5.2 UI é€‚é…

- [ ] **Ribbon UI é€‚é…**

  - [ ] éªŒè¯ PowerPoint Ribbon æ­£å¸¸
  - [ ] éªŒè¯ WPS Ribbonï¼ˆå¦‚æœæ”¯æŒï¼‰
  - [ ] å¤„ç† UI å·®å¼‚

- [ ] **å¿«æ·é”®ç³»ç»Ÿé€‚é…**

  - [ ] æµ‹è¯• PowerPoint å¿«æ·é”®
  - [ ] æµ‹è¯• WPS å¿«æ·é”®

- [ ] **å¯¹è¯æ¡†é€‚é…**
  - [ ] æµ‹è¯•è®¾ç½®å¯¹è¯æ¡†
  - [ ] æµ‹è¯•å…³äºå¯¹è¯æ¡†

#### 3.5.3 åŠŸèƒ½é™çº§å¤„ç†

- [ ] **å®ç°åŠŸèƒ½æ£€æµ‹æœºåˆ¶**

  ```csharp
  // Core/Compatibility/FeatureCompatibility.cs
  public static class FeatureCompatibility
  {
      public static bool IsFeatureSupported(IApplication app, Feature feature)
      {
          switch (app.Type)
          {
              case ApplicationType.PowerPoint:
                  return true;

              case ApplicationType.WPSPresentation:
                  return CheckWPSFeatureSupport(feature);

              default:
                  return false;
          }
      }

      private static bool CheckWPSFeatureSupport(Feature feature)
      {
          // WPSåŠŸèƒ½æ”¯æŒè¡¨
          var support = new Dictionary<Feature, bool>
          {
              { Feature.TableFormatting, true },
              { Feature.TextFormatting, true },
              { Feature.ChartFormatting, true },
              { Feature.AdvancedTableStyles, false },
              // ...
          };

          return support.GetValueOrDefault(feature, false);
      }
  }
  ```

- [ ] **æä¾›å‹å¥½çš„é™çº§æç¤º**
  - [ ] æ£€æµ‹ä¸æ”¯æŒçš„åŠŸèƒ½
  - [ ] æ˜¾ç¤ºå‹å¥½çš„æç¤ºä¿¡æ¯

#### 3.5.4 åŠŸèƒ½æµ‹è¯•

- [ ] **PowerPoint åŠŸèƒ½å›å½’æµ‹è¯•**

  - [ ] æ‰€æœ‰åŠŸèƒ½æµ‹è¯•é€šè¿‡
  - [ ] æ€§èƒ½æµ‹è¯•é€šè¿‡

- [ ] **WPS åŠŸèƒ½æµ‹è¯•**

  - [ ] åŸºæœ¬åŠŸèƒ½æµ‹è¯•
  - [ ] å…¼å®¹æ€§æµ‹è¯•

- [ ] **è·¨å¹³å°å…¼å®¹æ€§æµ‹è¯•**
  - [ ] åŒä¸€åŠŸèƒ½åœ¨ä¸åŒå¹³å°çš„è¡¨ç°
  - [ ] é…ç½®æ–‡ä»¶å…¼å®¹æ€§

#### 3.5.5 æ€§èƒ½ä¼˜åŒ–

- [ ] **æ€§èƒ½å¯¹æ¯”æµ‹è¯•**

  - [ ] PowerPoint æ€§èƒ½åŸºå‡†
  - [ ] WPS æ€§èƒ½åŸºå‡†
  - [ ] å¯¹æ¯”åˆ†æ

- [ ] **ä¼˜åŒ–é€‚é…å™¨æ€§èƒ½**

  - [ ] å‡å°‘ä¸å¿…è¦çš„å¯¹è±¡åˆ›å»º
  - [ ] ä¼˜åŒ– COM è°ƒç”¨

- [ ] **å†…å­˜æ³„æ¼æ£€æŸ¥**
  - [ ] COM å¯¹è±¡é‡Šæ”¾æ£€æŸ¥
  - [ ] é€‚é…å™¨å¯¹è±¡ç”Ÿå‘½å‘¨æœŸç®¡ç†

#### 3.5.6 éªŒæ”¶æ ‡å‡†

- [ ] æ‰€æœ‰åŠŸèƒ½æµ‹è¯•é€šè¿‡
- [ ] æ€§èƒ½æ»¡è¶³è¦æ±‚
- [ ] æ— å†…å­˜æ³„æ¼
- [ ] æ–‡æ¡£æ›´æ–°å®Œæˆ

---

## ğŸ“Š å››ã€æ—¶é—´ä¼°ç®—

### 4.1 å„é˜¶æ®µæ—¶é—´

| é˜¶æ®µ     | å·¥ä½œå†…å®¹        | æ—¶é—´ä¼°ç®—                   |
| -------- | --------------- | -------------------------- |
| é˜¶æ®µä¸€   | DI å®¹å™¨åŸºç¡€è®¾æ–½ | 1-2 å‘¨                     |
| é˜¶æ®µäºŒ   | ä¸šåŠ¡å±‚é‡æ„      | 2-3 å‘¨                     |
| é˜¶æ®µä¸‰   | å¹³å°æŠ½è±¡å±‚      | 2-3 å‘¨                     |
| é˜¶æ®µå››   | WPS é€‚é…å™¨å¼€å‘  | 3-4 å‘¨                     |
| é˜¶æ®µäº”   | åŠŸèƒ½é€‚é…å’Œæµ‹è¯•  | 2-3 å‘¨                     |
| **æ€»è®¡** |                 | **10-15 å‘¨**ï¼ˆ2.5-4 ä¸ªæœˆï¼‰ |

### 4.2 èµ„æºéœ€æ±‚

- **å¼€å‘äººå‘˜**: 1-2 äºº
- **æµ‹è¯•ç¯å¢ƒ**: PowerPoint 2016+, WPS æ¼”ç¤º
- **å¼€å‘å·¥å…·**: Visual Studio 2019+, .NET Framework 4.8

---

## âš ï¸ äº”ã€é£é™©å’Œæ³¨æ„äº‹é¡¹

### 5.1 æŠ€æœ¯é£é™©

1. **WPS COM API å…¼å®¹æ€§æœªçŸ¥**

   - **é£é™©**: WPS COM API å¯èƒ½ä¸ PowerPoint ä¸å®Œå…¨å…¼å®¹
   - **ç¼“è§£**: å……åˆ†æµ‹è¯•ï¼Œå®ç°é™çº§æ–¹æ¡ˆ

2. **é‡æ„èŒƒå›´å¤§**

   - **é£é™©**: é‡æ„å¯èƒ½å½±å“ç°æœ‰åŠŸèƒ½
   - **ç¼“è§£**: åˆ†é˜¶æ®µå®æ–½ï¼Œå……åˆ†æµ‹è¯•

3. **æ€§èƒ½å½±å“**
   - **é£é™©**: æŠ½è±¡å±‚å’Œ DI å®¹å™¨å¯èƒ½å¸¦æ¥æ€§èƒ½å¼€é”€
   - **ç¼“è§£**: ä¼˜åŒ–å®ç°ï¼Œæ€§èƒ½æµ‹è¯•

### 5.2 æ³¨æ„äº‹é¡¹

1. **ä¿æŒå‘åå…¼å®¹**: è€ƒè™‘ä¿ç•™é™æ€æ–¹æ³•ä½œä¸ºä¾¿æ·å…¥å£
2. **COM å¯¹è±¡ç”Ÿå‘½å‘¨æœŸ**: ç¡®ä¿æ­£ç¡®ç®¡ç† COM å¯¹è±¡
3. **æµ‹è¯•è¦†ç›–**: æ¯ä¸ªé˜¶æ®µéƒ½è¦å……åˆ†æµ‹è¯•
4. **æ–‡æ¡£æ›´æ–°**: åŠæ—¶æ›´æ–°ç›¸å…³æ–‡æ¡£

---

## ğŸ“ å…­ã€éªŒæ”¶æ ‡å‡†

### 6.1 é˜¶æ®µéªŒæ”¶

æ¯ä¸ªé˜¶æ®µå®Œæˆåéœ€è¦ï¼š

- [ ] ä»£ç å®¡æŸ¥é€šè¿‡
- [ ] åŠŸèƒ½æµ‹è¯•é€šè¿‡
- [ ] å•å…ƒæµ‹è¯•é€šè¿‡ï¼ˆå¦‚æœé€‚ç”¨ï¼‰
- [ ] æ–‡æ¡£æ›´æ–°å®Œæˆ

### 6.2 æœ€ç»ˆéªŒæ”¶

- [ ] PowerPoint åŠŸèƒ½å®Œå…¨æ­£å¸¸
- [ ] WPS åŠŸèƒ½åŸºæœ¬æ­£å¸¸ï¼ˆæ”¯æŒçš„åŠŸèƒ½ï¼‰
- [ ] ä»£ç è´¨é‡ç¬¦åˆæ ‡å‡†
- [ ] æ€§èƒ½æ»¡è¶³è¦æ±‚
- [ ] æ–‡æ¡£å®Œæ•´

---

## ğŸ¯ ä¸ƒã€æ€»ç»“

æœ¬æ•´åˆæ–¹æ¡ˆå°† DI å®¹å™¨å’Œå¹³å°æŠ½è±¡å±‚ä¸¤ä¸ªæ–¹æ¡ˆæœ‰æœºç»“åˆï¼Œé€šè¿‡åˆ†é˜¶æ®µå®æ–½ï¼Œé€æ­¥å®Œæˆæ¶æ„é‡æ„ã€‚æ–¹æ¡ˆå…·æœ‰ä»¥ä¸‹ç‰¹ç‚¹ï¼š

1. âœ… **åˆ†é˜¶æ®µå®æ–½**: é™ä½é£é™©ï¼Œä¾¿äºç®¡ç†
2. âœ… **åŸºç¡€å…ˆè¡Œ**: å…ˆå»ºç«‹ DI åŸºç¡€è®¾æ–½ï¼Œå†å®æ–½å¹³å°æŠ½è±¡
3. âœ… **å……åˆ†æµ‹è¯•**: æ¯ä¸ªé˜¶æ®µéƒ½æœ‰æµ‹è¯•è¦æ±‚
4. âœ… **å‘åå…¼å®¹**: è€ƒè™‘ä¿æŒç°æœ‰åŠŸèƒ½æ­£å¸¸

**å»ºè®®**: æŒ‰ç…§æœ¬æ–¹æ¡ˆåˆ†é˜¶æ®µå®æ–½ï¼Œæ¯ä¸ªé˜¶æ®µå®Œæˆåè¿›è¡Œè¯„ä¼°ï¼Œæ ¹æ®å®é™…æƒ…å†µè°ƒæ•´åç»­è®¡åˆ’ã€‚

---

## ğŸ“ ç‰ˆæœ¬å˜æ›´è®°å½•

### v1.1 (2025-01) - æ¶æ„é‡æ„å®æ–½

**å®æ–½çŠ¶æ€**ï¼š

- âœ… **é˜¶æ®µä¸€å®Œæˆ**ï¼šDI å®¹å™¨åŸºç¡€è®¾æ–½å·²å»ºç«‹
- âœ… **é˜¶æ®µäºŒå®Œæˆ**ï¼šä¸šåŠ¡é€»è¾‘é‡æ„ä¸ºå®ä¾‹ç±»ï¼Œæ”¯æŒä¾èµ–æ³¨å…¥
- âœ… **é˜¶æ®µä¸‰å®Œæˆ**ï¼šå¹³å°æŠ½è±¡æ¥å£å±‚å·²åˆ›å»º
- âœ… **é˜¶æ®µå››å®Œæˆ**ï¼šPowerPoint é€‚é…å™¨å·²å®ç°
- âš ï¸ **WPS é€‚é…å›é€€**ï¼šç”±äºå…¼å®¹æ€§é—®é¢˜ï¼Œæš‚æ—¶å›é€€ WPS é€‚é…æ”¯æŒï¼Œä¸“æ³¨äº PowerPoint å¹³å°ä¼˜åŒ–

**ä¸»è¦å˜æ›´**ï¼š

1. å¼•å…¥ `Microsoft.Extensions.DependencyInjection` DI å®¹å™¨
2. åˆ›å»ºå¹³å°æŠ½è±¡æ¥å£å±‚ï¼ˆ`IApplication`ã€`IShape`ã€`ITable`ã€`IChart` ç­‰ï¼‰
3. å®ç° PowerPoint é€‚é…å™¨ï¼ˆ`PowerPointApplication`ã€`PowerPointShape`ã€`PowerPointTable` ç­‰ï¼‰
4. é‡æ„æ ¼å¼åŒ–è¾…åŠ©ç±»ï¼ˆ`TableFormatHelper`ã€`TextFormatHelper`ã€`ChartFormatHelper`ï¼‰æ”¯æŒä¾èµ–æ³¨å…¥
5. é‡æ„æ‰¹é‡æ“ä½œç±»ï¼ˆ`TableBatchHelper`ã€`TextBatchHelper`ã€`ChartBatchHelper`ï¼‰ä½¿ç”¨æŠ½è±¡æ¥å£
6. åˆ›å»º `AdapterUtils` ç»Ÿä¸€é€‚é…å™¨åŒ…è£…å·¥å…·
7. ç§»é™¤ WPS é€‚é…å™¨ç›¸å…³ä»£ç ï¼Œå›é€€åˆ°ä»…æ”¯æŒ PowerPoint

**æŠ€æœ¯å€ºåŠ¡**ï¼š

- WPS é€‚é…æ”¯æŒå·²ç§»é™¤ï¼Œå¦‚éœ€é‡æ–°æ”¯æŒéœ€è¦é‡æ–°å®ç°
- å¹³å°æŠ½è±¡å±‚å·²å»ºç«‹ï¼Œä¸ºæœªæ¥å¤šå¹³å°æ”¯æŒæ‰“ä¸‹åŸºç¡€

### v1.0 (2025-01) - åˆå§‹æ–¹æ¡ˆ

**æ–¹æ¡ˆè®¾è®¡**ï¼š

- æ•´åˆ DI å®¹å™¨æ–¹æ¡ˆå’Œå¹³å°æŠ½è±¡å±‚æ–¹æ¡ˆ
- åˆ¶å®šåˆ†é˜¶æ®µå®æ–½è®¡åˆ’
- å®šä¹‰æ¶æ„ç›®æ ‡å’Œå®æ–½æ­¥éª¤

---

**æ–‡æ¡£ç‰ˆæœ¬**: v1.1  
**æœ€åæ›´æ–°**: 2025 å¹´ 1 æœˆ  
**ç»´æŠ¤è€…**: PPA å¼€å‘å›¢é˜Ÿ
