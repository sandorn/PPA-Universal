# PPA é¡¹ç›®å¤šç‰ˆæœ¬åˆ†æ”¯è§„åˆ’æ–¹æ¡ˆ

**ç‰ˆæœ¬**: v1.0  
**åˆ¶å®šæ—¥æœŸ**: [å½“å‰æ—¥æœŸ]  
**çŠ¶æ€**: ğŸ“‹ æ–¹æ¡ˆè®¾è®¡é˜¶æ®µ

---

## ğŸ“‹ ä¸€ã€é¡¹ç›®èƒŒæ™¯ä¸ç›®æ ‡

### 1.1 å½“å‰çŠ¶æ€

PPA é¡¹ç›®å½“å‰æ˜¯ä¸€ä¸ªåŸºäº VSTO çš„ PowerPoint æ’ä»¶ï¼Œä¸»è¦ç‰¹ç‚¹ï¼š

- **æŠ€æœ¯æ ˆ**: VSTO + NetOffice + .NET Framework 4.8
- **ç›®æ ‡å¹³å°**: Microsoft PowerPoint
- **æ¶æ„**: å·²å…·å¤‡åŸºç¡€çš„æŠ½è±¡å±‚è®¾è®¡ï¼ˆ`Core/Abstraction/`ï¼‰
- **DI æ”¯æŒ**: å·²å¼•å…¥ `Microsoft.Extensions.DependencyInjection`

### 1.2 ç‰ˆæœ¬è§„åˆ’ç›®æ ‡

å°†é¡¹ç›®æ‹†åˆ†ä¸º **3 ä¸ªç‹¬ç«‹æ„å»ºç‰ˆæœ¬**ï¼š

| ç‰ˆæœ¬               | åç§°            | æ”¯æŒå¹³å°             | ä¼˜å…ˆçº§ |
| ------------------ | --------------- | -------------------- | ------ |
| **PPA.PowerPoint** | PowerPoint ä¸“ç‰ˆ | Microsoft PowerPoint | é«˜     |
| **PPA.WPS**        | WPS ä¸“ç‰ˆ        | WPS æ¼”ç¤º             | ä¸­     |
| **PPA.Universal**  | é€šç”¨ç‰ˆ          | PowerPoint + WPS     | ä½     |

### 1.3 æ ¸å¿ƒçº¦æŸ

- âœ… **æœ€å¤§åŒ–ä»£ç å¤ç”¨**ï¼šä¸šåŠ¡é€»è¾‘å±‚å…±äº«
- âœ… **ç‹¬ç«‹æ„å»ºå‘å¸ƒ**ï¼šå„ç‰ˆæœ¬å¯ç‹¬ç«‹ç¼–è¯‘ã€æ‰“åŒ…ã€å‘å¸ƒ
- âœ… **å¹¶è¡Œå¼€å‘**ï¼šå›¢é˜Ÿå¯åŒæ—¶æ¨è¿›å¤šä¸ªç‰ˆæœ¬
- âœ… **æœ€å°åŒ–ç»´æŠ¤æˆæœ¬**ï¼šé¿å…ä»£ç åˆ†å‰å’Œé‡å¤

---

## ğŸ—ï¸ äºŒã€æ¶æ„è®¾è®¡

### 2.1 æ•´ä½“æ¶æ„

é‡‡ç”¨ **"å…±äº«æ ¸å¿ƒ + å¹³å°é€‚é…å™¨ + ç‰ˆæœ¬å£³"** çš„ä¸‰å±‚æ¶æ„ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ç‰ˆæœ¬å£³å±‚ (Entry Points)                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  PPA.PowerPoint   â”‚     PPA.WPS       â”‚   PPA.Universal     â”‚
â”‚  (VSTO Add-in)    â”‚  (COM/WPSæ’ä»¶)    â”‚   (æ¡ä»¶åŠ è½½)        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 å¹³å°é€‚é…å™¨å±‚ (Adapters)                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   PPA.Adapter.PowerPoint    â”‚      PPA.Adapter.WPS          â”‚
â”‚   - PowerPointAppProvider   â”‚      - WPSAppProvider         â”‚
â”‚   - NetOffice å®ç°          â”‚      - COM dynamic å®ç°        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  å…±äº«æ ¸å¿ƒå±‚ (Shared Core)                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  PPA.Core          - æŠ½è±¡æ¥å£ã€DIã€æ—¥å¿—ã€å¼‚å¸¸å¤„ç†            â”‚
â”‚  PPA.Business      - æ ¼å¼åŒ–ã€æ‰¹é‡æ“ä½œã€å¯¹é½ç­‰ä¸šåŠ¡é€»è¾‘         â”‚
â”‚  PPA.UI.Shared     - å…±äº«UIç»„ä»¶ï¼ˆFormsã€èµ„æºï¼‰               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.2 é¡¹ç›®ç»“æ„

```
PPA/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ Core/                           # å…±äº«æ ¸å¿ƒåº“
â”‚   â”‚   â”œâ”€â”€ PPA.Core/                   # åŸºç¡€è®¾æ–½
â”‚   â”‚   â”‚   â”œâ”€â”€ Abstraction/            # å¹³å°æ— å…³æ¥å£
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ IApplicationContext.cs
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ ISlideOperations.cs
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ IShapeOperations.cs
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ ITableOperations.cs
â”‚   â”‚   â”‚   â”œâ”€â”€ DI/
â”‚   â”‚   â”‚   â”œâ”€â”€ Logging/
â”‚   â”‚   â”‚   â””â”€â”€ ExHandler.cs
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ PPA.Business/               # ä¸šåŠ¡é€»è¾‘ï¼ˆå¹³å°æ— å…³ï¼‰
â”‚   â”‚   â”‚   â”œâ”€â”€ Formatting/
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ TableFormatService.cs
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ TextFormatService.cs
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ ChartFormatService.cs
â”‚   â”‚   â”‚   â”œâ”€â”€ Alignment/
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ AlignmentService.cs
â”‚   â”‚   â”‚   â””â”€â”€ Batch/
â”‚   â”‚   â”‚       â”œâ”€â”€ TableBatchService.cs
â”‚   â”‚   â”‚       â””â”€â”€ ShapeBatchService.cs
â”‚   â”‚   â”‚
â”‚   â”‚   â””â”€â”€ PPA.UI.Shared/              # å…±äº«UIç»„ä»¶
â”‚   â”‚       â”œâ”€â”€ Forms/
â”‚   â”‚       â”œâ”€â”€ Resources/
â”‚   â”‚       â””â”€â”€ Ribbon/
â”‚   â”‚           â””â”€â”€ RibbonDefinition.xml
â”‚   â”‚
â”‚   â”œâ”€â”€ Adapters/                       # å¹³å°é€‚é…å™¨
â”‚   â”‚   â”œâ”€â”€ PPA.Adapter.PowerPoint/     # PowerPoint é€‚é…å™¨
â”‚   â”‚   â”‚   â”œâ”€â”€ PowerPointContext.cs
â”‚   â”‚   â”‚   â”œâ”€â”€ PowerPointSlideOps.cs
â”‚   â”‚   â”‚   â”œâ”€â”€ PowerPointShapeOps.cs
â”‚   â”‚   â”‚   â””â”€â”€ PowerPointTableOps.cs
â”‚   â”‚   â”‚
â”‚   â”‚   â””â”€â”€ PPA.Adapter.WPS/            # WPS é€‚é…å™¨
â”‚   â”‚       â”œâ”€â”€ WPSContext.cs
â”‚   â”‚       â”œâ”€â”€ WPSSlideOps.cs
â”‚   â”‚       â”œâ”€â”€ WPSShapeOps.cs
â”‚   â”‚       â””â”€â”€ WPSTableOps.cs
â”‚   â”‚
â”‚   â””â”€â”€ Hosts/                          # ç‰ˆæœ¬å…¥å£
â”‚       â”œâ”€â”€ PPA.PowerPoint/             # PowerPoint ä¸“ç‰ˆ (VSTO)
â”‚       â”‚   â”œâ”€â”€ ThisAddIn.cs
â”‚       â”‚   â”œâ”€â”€ CustomRibbon.cs
â”‚       â”‚   â””â”€â”€ PPA.PowerPoint.csproj
â”‚       â”‚
â”‚       â”œâ”€â”€ PPA.WPS/                    # WPS ä¸“ç‰ˆ
â”‚       â”‚   â”œâ”€â”€ WPSAddIn.cs
â”‚       â”‚   â”œâ”€â”€ WPSRibbon.cs
â”‚       â”‚   â””â”€â”€ PPA.WPS.csproj
â”‚       â”‚
â”‚       â””â”€â”€ PPA.Universal/              # é€šç”¨ç‰ˆ
â”‚           â”œâ”€â”€ UniversalAddIn.cs
â”‚           â”œâ”€â”€ PlatformDetector.cs
â”‚           â””â”€â”€ PPA.Universal.csproj
â”‚
â”œâ”€â”€ tests/                              # æµ‹è¯•é¡¹ç›®
â”‚   â”œâ”€â”€ PPA.Core.Tests/
â”‚   â”œâ”€â”€ PPA.Business.Tests/
â”‚   â””â”€â”€ PPA.Integration.Tests/
â”‚
â”œâ”€â”€ build/                              # æ„å»ºè„šæœ¬
â”‚   â”œâ”€â”€ build-powerpoint.ps1
â”‚   â”œâ”€â”€ build-wps.ps1
â”‚   â”œâ”€â”€ build-universal.ps1
â”‚   â””â”€â”€ build-all.ps1
â”‚
â””â”€â”€ PPA.sln                             # è§£å†³æ–¹æ¡ˆæ–‡ä»¶
```

### 2.3 é¡¹ç›®å¼•ç”¨å…³ç³»

```
PPA.PowerPoint â”€â”€â”€â”€â”€â”€â”
                     â”œâ”€â”€â†’ PPA.Adapter.PowerPoint â”€â”€â†’ PPA.Core
PPA.Universal â”€â”€â”€â”€â”€â”€â”€â”¤                               PPA.Business
                     â”œâ”€â”€â†’ PPA.Adapter.WPS â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ PPA.UI.Shared
PPA.WPS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”§ ä¸‰ã€æ ¸å¿ƒæ¥å£è®¾è®¡

### 3.1 åº”ç”¨ä¸Šä¸‹æ–‡æ¥å£

```csharp
// PPA.Core/Abstraction/IApplicationContext.cs
namespace PPA.Core.Abstraction
{
    /// <summary>
    /// å¹³å°æ— å…³çš„åº”ç”¨ç¨‹åºä¸Šä¸‹æ–‡æ¥å£
    /// </summary>
    public interface IApplicationContext
    {
        /// <summary>å½“å‰å¹³å°ç±»å‹</summary>
        PlatformType Platform { get; }

        /// <summary>å½“å‰æ´»åŠ¨çš„æ¼”ç¤ºæ–‡ç¨¿</summary>
        IPresentationContext ActivePresentation { get; }

        /// <summary>å½“å‰æ´»åŠ¨çš„çª—å£</summary>
        IWindowContext ActiveWindow { get; }

        /// <summary>å½“å‰é€‰æ‹©</summary>
        ISelectionContext Selection { get; }

        /// <summary>æ£€æŸ¥ç‰¹æ€§æ˜¯å¦æ”¯æŒ</summary>
        bool IsFeatureSupported(Feature feature);
    }

    public enum PlatformType
    {
        Unknown = 0,
        PowerPoint = 1,
        WPS = 2
    }
}
```

### 3.2 å½¢çŠ¶æ“ä½œæ¥å£

```csharp
// PPA.Core/Abstraction/IShapeOperations.cs
namespace PPA.Core.Abstraction
{
    /// <summary>
    /// å½¢çŠ¶æ“ä½œæ¥å£ï¼ˆå¹³å°æ— å…³ï¼‰
    /// </summary>
    public interface IShapeOperations
    {
        /// <summary>è·å–å½¢çŠ¶ä½ç½®</summary>
        ShapeRect GetBounds(object shape);

        /// <summary>è®¾ç½®å½¢çŠ¶ä½ç½®</summary>
        void SetBounds(object shape, ShapeRect bounds);

        /// <summary>è·å–å½¢çŠ¶æ—‹è½¬è§’åº¦</summary>
        float GetRotation(object shape);

        /// <summary>è®¾ç½®å½¢çŠ¶æ—‹è½¬è§’åº¦</summary>
        void SetRotation(object shape, float angle);

        /// <summary>åˆ¤æ–­æ˜¯å¦ä¸ºè¡¨æ ¼</summary>
        bool IsTable(object shape);

        /// <summary>åˆ¤æ–­æ˜¯å¦ä¸ºå›¾è¡¨</summary>
        bool IsChart(object shape);
    }

    public struct ShapeRect
    {
        public float Left { get; set; }
        public float Top { get; set; }
        public float Width { get; set; }
        public float Height { get; set; }
    }
}
```

### 3.3 è¡¨æ ¼æ“ä½œæ¥å£

```csharp
// PPA.Core/Abstraction/ITableOperations.cs
namespace PPA.Core.Abstraction
{
    /// <summary>
    /// è¡¨æ ¼æ“ä½œæ¥å£ï¼ˆå¹³å°æ— å…³ï¼‰
    /// </summary>
    public interface ITableOperations
    {
        /// <summary>è·å–è¡¨æ ¼è¡Œæ•°</summary>
        int GetRowCount(object table);

        /// <summary>è·å–è¡¨æ ¼åˆ—æ•°</summary>
        int GetColumnCount(object table);

        /// <summary>è·å–å•å…ƒæ ¼</summary>
        object GetCell(object table, int row, int col);

        /// <summary>è®¾ç½®å•å…ƒæ ¼æ–‡æœ¬</summary>
        void SetCellText(object cell, string text);

        /// <summary>è®¾ç½®å•å…ƒæ ¼èƒŒæ™¯è‰²</summary>
        void SetCellBackground(object cell, int colorRgb);

        /// <summary>è®¾ç½®è¾¹æ¡†æ ·å¼</summary>
        void SetBorderStyle(object cell, BorderEdge edge, BorderStyle style);
    }
}
```

---

## ğŸ“¦ å››ã€DI æœåŠ¡æ³¨å†Œç­–ç•¥

### 4.1 æ ¸å¿ƒæœåŠ¡æ³¨å†Œï¼ˆå…±äº«ï¼‰

```csharp
// PPA.Core/DI/CoreServiceExtensions.cs
namespace PPA.Core.DI
{
    public static class CoreServiceExtensions
    {
        /// <summary>
        /// æ³¨å†Œæ ¸å¿ƒæœåŠ¡ï¼ˆæ‰€æœ‰ç‰ˆæœ¬å…±äº«ï¼‰
        /// </summary>
        public static IServiceCollection AddPPACore(this IServiceCollection services)
        {
            // é…ç½®æœåŠ¡
            services.AddSingleton<IFormattingConfig>(sp => FormattingConfig.Instance);

            // æ—¥å¿—æœåŠ¡
            services.AddSingleton<ILogger, ProfilerLoggerAdapter>();

            // èµ„æºç®¡ç†
            services.AddSingleton<IResourceManager, ResourceManager>();

            return services;
        }

        /// <summary>
        /// æ³¨å†Œä¸šåŠ¡æœåŠ¡ï¼ˆæ‰€æœ‰ç‰ˆæœ¬å…±äº«ï¼‰
        /// </summary>
        public static IServiceCollection AddPPABusiness(this IServiceCollection services)
        {
            // æ ¼å¼åŒ–æœåŠ¡
            services.AddTransient<ITableFormatService, TableFormatService>();
            services.AddTransient<ITextFormatService, TextFormatService>();
            services.AddTransient<IChartFormatService, ChartFormatService>();

            // æ‰¹é‡æ“ä½œæœåŠ¡
            services.AddTransient<ITableBatchService, TableBatchService>();
            services.AddTransient<IShapeBatchService, ShapeBatchService>();

            // å¯¹é½æœåŠ¡
            services.AddTransient<IAlignmentService, AlignmentService>();

            return services;
        }
    }
}
```

### 4.2 PowerPoint é€‚é…å™¨æ³¨å†Œ

```csharp
// PPA.Adapter.PowerPoint/DI/PowerPointAdapterExtensions.cs
namespace PPA.Adapter.PowerPoint.DI
{
    public static class PowerPointAdapterExtensions
    {
        public static IServiceCollection AddPowerPointAdapter(
            this IServiceCollection services)
        {
            // æ³¨å†Œ PowerPoint ç‰¹å®šå®ç°
            services.AddSingleton<IApplicationContext, PowerPointContext>();
            services.AddSingleton<IShapeOperations, PowerPointShapeOps>();
            services.AddSingleton<ITableOperations, PowerPointTableOps>();
            services.AddSingleton<ISlideOperations, PowerPointSlideOps>();

            return services;
        }
    }
}
```

### 4.3 WPS é€‚é…å™¨æ³¨å†Œ

```csharp
// PPA.Adapter.WPS/DI/WPSAdapterExtensions.cs
namespace PPA.Adapter.WPS.DI
{
    public static class WPSAdapterExtensions
    {
        public static IServiceCollection AddWPSAdapter(
            this IServiceCollection services)
        {
            // æ³¨å†Œ WPS ç‰¹å®šå®ç°
            services.AddSingleton<IApplicationContext, WPSContext>();
            services.AddSingleton<IShapeOperations, WPSShapeOps>();
            services.AddSingleton<ITableOperations, WPSTableOps>();
            services.AddSingleton<ISlideOperations, WPSSlideOps>();

            return services;
        }
    }
}
```

### 4.4 å„ç‰ˆæœ¬å…¥å£é…ç½®

```csharp
// PPA.PowerPoint/ThisAddIn.cs - PowerPoint ä¸“ç‰ˆ
private void InitializeDIContainer()
{
    var services = new ServiceCollection();
    services.AddPPACore();
    services.AddPPABusiness();
    services.AddPowerPointAdapter();  // PowerPoint é€‚é…å™¨
    _serviceProvider = services.BuildServiceProvider();
}

// PPA.WPS/WPSAddIn.cs - WPS ä¸“ç‰ˆ
private void InitializeDIContainer()
{
    var services = new ServiceCollection();
    services.AddPPACore();
    services.AddPPABusiness();
    services.AddWPSAdapter();  // WPS é€‚é…å™¨
    _serviceProvider = services.BuildServiceProvider();
}

// PPA.Universal/UniversalAddIn.cs - é€šç”¨ç‰ˆ
private void InitializeDIContainer()
{
    var services = new ServiceCollection();
    services.AddPPACore();
    services.AddPPABusiness();

    // è¿è¡Œæ—¶æ£€æµ‹å¹³å°
    var platform = PlatformDetector.Detect();
    switch (platform)
    {
        case PlatformType.PowerPoint:
            services.AddPowerPointAdapter();
            break;
        case PlatformType.WPS:
            services.AddWPSAdapter();
            break;
        default:
            throw new PlatformNotSupportedException();
    }

    _serviceProvider = services.BuildServiceProvider();
}
```

---

## ğŸ”„ äº”ã€ç‰ˆæœ¬æ„å»ºç­–ç•¥

### 5.1 æ¡ä»¶ç¼–è¯‘ç¬¦å·

| é¡¹ç›®           | ç¼–è¯‘ç¬¦å·     |
| -------------- | ------------ |
| PPA.PowerPoint | `POWERPOINT` |
| PPA.WPS        | `WPS`        |
| PPA.Universal  | `UNIVERSAL`  |

### 5.2 é¡¹ç›®æ–‡ä»¶é…ç½®ç¤ºä¾‹

```xml
<!-- PPA.PowerPoint.csproj -->
<Project Sdk="Microsoft.NET.Sdk">
  <PropertyGroup>
    <TargetFramework>net48</TargetFramework>
    <OutputType>Library</OutputType>
    <DefineConstants>POWERPOINT;VSTO40</DefineConstants>
  </PropertyGroup>

  <ItemGroup>
    <ProjectReference Include="..\..\Core\PPA.Core\PPA.Core.csproj" />
    <ProjectReference Include="..\..\Core\PPA.Business\PPA.Business.csproj" />
    <ProjectReference Include="..\..\Adapters\PPA.Adapter.PowerPoint\PPA.Adapter.PowerPoint.csproj" />
  </ItemGroup>
</Project>
```

```xml
<!-- PPA.WPS.csproj -->
<Project Sdk="Microsoft.NET.Sdk">
  <PropertyGroup>
    <TargetFramework>net48</TargetFramework>
    <OutputType>Library</OutputType>
    <DefineConstants>WPS</DefineConstants>
  </PropertyGroup>

  <ItemGroup>
    <ProjectReference Include="..\..\Core\PPA.Core\PPA.Core.csproj" />
    <ProjectReference Include="..\..\Core\PPA.Business\PPA.Business.csproj" />
    <ProjectReference Include="..\..\Adapters\PPA.Adapter.WPS\PPA.Adapter.WPS.csproj" />
  </ItemGroup>
</Project>
```

### 5.3 æ„å»ºè„šæœ¬

```powershell
# build/build-all.ps1
param(
    [string]$Configuration = "Release"
)

Write-Host "æ„å»º PPA æ‰€æœ‰ç‰ˆæœ¬..." -ForegroundColor Cyan

# æ„å»ºå…±äº«åº“
dotnet build src/Core/PPA.Core/PPA.Core.csproj -c $Configuration
dotnet build src/Core/PPA.Business/PPA.Business.csproj -c $Configuration

# æ„å»ºé€‚é…å™¨
dotnet build src/Adapters/PPA.Adapter.PowerPoint/PPA.Adapter.PowerPoint.csproj -c $Configuration
dotnet build src/Adapters/PPA.Adapter.WPS/PPA.Adapter.WPS.csproj -c $Configuration

# æ„å»ºå„ç‰ˆæœ¬
dotnet build src/Hosts/PPA.PowerPoint/PPA.PowerPoint.csproj -c $Configuration
dotnet build src/Hosts/PPA.WPS/PPA.WPS.csproj -c $Configuration
dotnet build src/Hosts/PPA.Universal/PPA.Universal.csproj -c $Configuration

Write-Host "æ„å»ºå®Œæˆï¼" -ForegroundColor Green
```

---

## ğŸ“Š å…­ã€ä»£ç å¤ç”¨åˆ†æ

### 6.1 å¤ç”¨ç‡ä¼°ç®—

| å±‚çº§           | ä»£ç é‡å æ¯” | å¤ç”¨ç‡           |
| -------------- | ---------- | ---------------- |
| **å…±äº«æ ¸å¿ƒå±‚** | ~60%       | 100%             |
| **ä¸šåŠ¡é€»è¾‘å±‚** | ~25%       | 100%             |
| **å¹³å°é€‚é…å™¨** | ~10%       | 0%ï¼ˆå„å¹³å°ç‹¬ç«‹ï¼‰ |
| **ç‰ˆæœ¬å…¥å£**   | ~5%        | ~30%             |
| **æ€»ä½“**       | 100%       | **~85%**         |

### 6.2 å„å±‚èŒè´£

| å±‚çº§               | èŒè´£                     | ä»£ç ç‰¹ç‚¹               |
| ------------------ | ------------------------ | ---------------------- |
| **PPA.Core**       | æŠ½è±¡æ¥å£ã€DIã€æ—¥å¿—ã€å¼‚å¸¸ | çº¯æŠ½è±¡ï¼Œæ— å¹³å°ä¾èµ–     |
| **PPA.Business**   | æ ¼å¼åŒ–ã€å¯¹é½ã€æ‰¹é‡æ“ä½œ   | ä¾èµ–æŠ½è±¡æ¥å£ï¼Œå¹³å°æ— å…³ |
| **PPA.UI.Shared**  | Formsã€èµ„æºã€Ribbon å®šä¹‰ | å…±äº« UI ç»„ä»¶           |
| **PPA.Adapter.\*** | å¹³å° API å°è£…            | ç›´æ¥è°ƒç”¨å¹³å° COM API   |
| **PPA.Host.\***    | æ’ä»¶å…¥å£ã€DI é…ç½®        | å¹³å°ç‰¹å®šåˆå§‹åŒ–         |

---

## ğŸ“… ä¸ƒã€å®æ–½è·¯çº¿å›¾

### é˜¶æ®µä¸€ï¼šæ¶æ„é‡æ„ï¼ˆ2-3 å‘¨ï¼‰

**ç›®æ ‡**ï¼šå°†ç°æœ‰ä»£ç é‡æ„ä¸ºåˆ†å±‚æ¶æ„

| ä»»åŠ¡                        | å·¥ä½œé‡ | çŠ¶æ€      |
| --------------------------- | ------ | --------- |
| åˆ›å»ºæ–°è§£å†³æ–¹æ¡ˆç»“æ„          | 2 å¤©   | â¬œ å¾…å¼€å§‹ |
| æå– PPA.Core é¡¹ç›®          | 3 å¤©   | â¬œ å¾…å¼€å§‹ |
| æå– PPA.Business é¡¹ç›®      | 5 å¤©   | â¬œ å¾…å¼€å§‹ |
| å®ç° PPA.Adapter.PowerPoint | 3 å¤©   | â¬œ å¾…å¼€å§‹ |
| åˆ›å»º PPA.PowerPoint å…¥å£    | 2 å¤©   | â¬œ å¾…å¼€å§‹ |
| éªŒè¯ PowerPoint ç‰ˆæœ¬åŠŸèƒ½    | 2 å¤©   | â¬œ å¾…å¼€å§‹ |

### é˜¶æ®µäºŒï¼šWPS é€‚é…å™¨å¼€å‘ï¼ˆ3-4 å‘¨ï¼‰

**ç›®æ ‡**ï¼šå®ç° WPS å¹³å°æ”¯æŒ

| ä»»åŠ¡                   | å·¥ä½œé‡ | çŠ¶æ€      |
| ---------------------- | ------ | --------- |
| WPS COM API ç ”ç©¶ä¸éªŒè¯ | 3 å¤©   | â¬œ å¾…å¼€å§‹ |
| å®ç° PPA.Adapter.WPS   | 7 å¤©   | â¬œ å¾…å¼€å§‹ |
| åˆ›å»º PPA.WPS å…¥å£      | 3 å¤©   | â¬œ å¾…å¼€å§‹ |
| WPS åŠŸèƒ½é€‚é…ä¸æµ‹è¯•     | 5 å¤©   | â¬œ å¾…å¼€å§‹ |
| å¤„ç†å¹³å°å·®å¼‚å’Œé™çº§     | 3 å¤©   | â¬œ å¾…å¼€å§‹ |

### é˜¶æ®µä¸‰ï¼šé€šç”¨ç‰ˆå¼€å‘ï¼ˆ1-2 å‘¨ï¼‰

**ç›®æ ‡**ï¼šå®ç°è¿è¡Œæ—¶å¹³å°æ£€æµ‹çš„é€šç”¨ç‰ˆæœ¬

| ä»»åŠ¡                    | å·¥ä½œé‡ | çŠ¶æ€      |
| ----------------------- | ------ | --------- |
| å®ç° PlatformDetector   | 2 å¤©   | â¬œ å¾…å¼€å§‹ |
| åˆ›å»º PPA.Universal å…¥å£ | 2 å¤©   | â¬œ å¾…å¼€å§‹ |
| åŠ¨æ€åŠ è½½é€‚é…å™¨æœºåˆ¶      | 3 å¤©   | â¬œ å¾…å¼€å§‹ |
| é›†æˆæµ‹è¯•                | 3 å¤©   | â¬œ å¾…å¼€å§‹ |

### é˜¶æ®µå››ï¼šæµ‹è¯•ä¸å‘å¸ƒï¼ˆ2 å‘¨ï¼‰

**ç›®æ ‡**ï¼šå®Œå–„æµ‹è¯•ï¼Œå‡†å¤‡å‘å¸ƒ

| ä»»åŠ¡         | å·¥ä½œé‡ | çŠ¶æ€      |
| ------------ | ------ | --------- |
| å•å…ƒæµ‹è¯•è¡¥å…… | 3 å¤©   | â¬œ å¾…å¼€å§‹ |
| é›†æˆæµ‹è¯•     | 3 å¤©   | â¬œ å¾…å¼€å§‹ |
| æ‰“åŒ…è„šæœ¬ç¼–å†™ | 2 å¤©   | â¬œ å¾…å¼€å§‹ |
| æ–‡æ¡£æ›´æ–°     | 2 å¤©   | â¬œ å¾…å¼€å§‹ |

---

## âš ï¸ å…«ã€é£é™©ä¸åº”å¯¹

### 8.1 æŠ€æœ¯é£é™©

| é£é™©                   | å½±å“ | åº”å¯¹ç­–ç•¥                         |
| ---------------------- | ---- | -------------------------------- |
| WPS COM API å…¼å®¹æ€§ä¸è¶³ | é«˜   | ä¼˜å…ˆéªŒè¯æ ¸å¿ƒ APIï¼›å®ç°åŠŸèƒ½é™çº§   |
| æ€§èƒ½å¼€é”€               | ä¸­   | æŠ½è±¡å±‚ä½¿ç”¨è½»é‡æ¥å£ï¼›å…³é”®è·¯å¾„ä¼˜åŒ– |
| é‡æ„å¼•å…¥å›å½’           | ä¸­   | ä¿æŒæµ‹è¯•è¦†ç›–ï¼›åˆ†æ­¥é‡æ„éªŒè¯       |

### 8.2 é¡¹ç›®é£é™©

| é£é™©          | å½±å“ | åº”å¯¹ç­–ç•¥                             |
| ------------- | ---- | ------------------------------------ |
| å·¥ä½œé‡è¶…é¢„æœŸ  | ä¸­   | åˆ†é˜¶æ®µäº¤ä»˜ï¼›ä¼˜å…ˆä¿è¯ PowerPoint ç‰ˆæœ¬ |
| å¹³å° API å˜æ›´ | ä½   | é€‚é…å™¨å±‚éš”ç¦»å˜åŒ–ï¼›ç‰ˆæœ¬å…¼å®¹å¤„ç†       |

---

## ğŸ¯ ä¹ã€å†³ç­–å»ºè®®

### 9.1 æ¨èå®æ–½é¡ºåº

1. **ç¬¬ä¸€ä¼˜å…ˆçº§**ï¼šå®Œæˆæ¶æ„é‡æ„ï¼Œç¡®ä¿ PowerPoint ç‰ˆæœ¬ç¨³å®š
2. **ç¬¬äºŒä¼˜å…ˆçº§**ï¼šå¼€å‘ WPS é€‚é…å™¨ï¼ŒéªŒè¯æŠ€æœ¯å¯è¡Œæ€§
3. **ç¬¬ä¸‰ä¼˜å…ˆçº§**ï¼šå®ç°é€šç”¨ç‰ˆæœ¬ï¼ˆå¯é€‰ï¼Œè§†éœ€æ±‚å†³å®šï¼‰

### 9.2 ç‰ˆæœ¬ç­–ç•¥å»ºè®®

| åœºæ™¯                   | æ¨èç‰ˆæœ¬       | ç†ç”±                 |
| ---------------------- | -------------- | -------------------- |
| ä¼ä¸šç”¨æˆ·ï¼ˆOffice 365ï¼‰ | PPA.PowerPoint | æœ€ä½³å…¼å®¹æ€§å’ŒåŠŸèƒ½æ”¯æŒ |
| ä¼ä¸šç”¨æˆ·ï¼ˆWPSï¼‰        | PPA.WPS        | é’ˆå¯¹æ€§ä¼˜åŒ–           |
| ä¸ªäººç”¨æˆ·ï¼ˆæ··åˆç¯å¢ƒï¼‰   | PPA.Universal  | è‡ªåŠ¨é€‚é…             |

### 9.3 ç®€åŒ–æ–¹æ¡ˆï¼ˆå¤‡é€‰ï¼‰

å¦‚æœèµ„æºæœ‰é™ï¼Œå¯ä»¥è€ƒè™‘ **ä¸¤ç‰ˆæœ¬æ–¹æ¡ˆ**ï¼š

- **PPA.PowerPoint**ï¼šä¿æŒç°çŠ¶ï¼ŒæŒç»­ç»´æŠ¤
- **PPA.Universal**ï¼šé€šç”¨ç‰ˆæœ¬ï¼Œé€šè¿‡è¿è¡Œæ—¶æ£€æµ‹æ”¯æŒä¸¤å¹³å°

è¿™æ ·å¯ä»¥å‡å°‘ç»´æŠ¤æˆæœ¬ï¼ŒåŒæ—¶æ»¡è¶³å¤šå¹³å°éœ€æ±‚ã€‚

---

## ğŸ“ åã€æ€»ç»“

æœ¬æ–¹æ¡ˆé€šè¿‡ **"å…±äº«æ ¸å¿ƒ + å¹³å°é€‚é…å™¨ + ç‰ˆæœ¬å£³"** çš„æ¶æ„è®¾è®¡ï¼Œå®ç°ï¼š

1. âœ… **~85% ä»£ç å¤ç”¨ç‡** - ä¸šåŠ¡é€»è¾‘å®Œå…¨å…±äº«
2. âœ… **ç‹¬ç«‹ç‰ˆæœ¬æ„å»º** - å„ç‰ˆæœ¬å¯ç‹¬ç«‹å‘å¸ƒ
3. âœ… **å¹¶è¡Œå¼€å‘æ”¯æŒ** - é€‚é…å™¨å±‚è§£è€¦ï¼Œå›¢é˜Ÿå¯å¹¶è¡Œå·¥ä½œ
4. âœ… **å¯æ‰©å±•æ¶æ„** - æœªæ¥å¯è½»æ¾æ”¯æŒå…¶ä»–å¹³å°

**å»ºè®®**ï¼šå…ˆå®Œæˆæ¶æ„é‡æ„å¹¶ç¨³å®š PowerPoint ç‰ˆæœ¬ï¼Œå†é€æ­¥å¼€å‘ WPS æ”¯æŒã€‚

---

**æ–‡æ¡£ç‰ˆæœ¬**: v1.0  
**ç»´æŠ¤è€…**: PPA å¼€å‘å›¢é˜Ÿ
